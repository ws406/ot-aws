from kafka import KafkaConsumer, KafkaProducer
from src.ops.game_predictor.fb_blended_true_odds import TrueOdds
import json

class Main():
	kafka_topic_input = 'event-new-game'
	kafka_topic_output = 'event-game-qualified'

	game_predictor = TrueOdds()

	print("Consumer / Game_qualifier (True Odds) starting...")

	def execute(self, debug_mode=False):
		# In debug mode, load test data, otherwise, read data from kafka
		if debug_mode:
			data_to_process = [
				{'game_id': 1669423, 'league_id': 60, 'kickoff': 1563703200.0, 'home_team_name': 'Beijing Renhe', 'away_team_name': 'Shanghai Shenhua', 'home_team_id': 3969, 'away_team_id': 39, 'home_team_rank': 16, 'away_team_rank': 13, 'league_name': 'Chinese Super League', 'odds': {'bet365': {1563682200: {'1': '3.5', 'x': '3.6', '2': '2'}, 1563682020: {'1': '3.6', 'x': '3.5', '2': '2'}, 1563648180: {'1': '3.8', 'x': '3.6', '2': '1.9'}, 1563628620: {'1': '3.4', 'x': '3.5', '2': '2.05'}, 1563479580: {'1': '3.25', 'x': '3.5', '2': '2.1'}, 1563460980: {'1': '3.3', 'x': '3.6', '2': '1.9'}, 1563407580: {'1': '3.1', 'x': '3.5', '2': '2.2'}}, 'betvictor': {1563697860: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563697440: {'1': '3.4', 'x': '3.75', '2': '1.95'}, 1563696660: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563696600: {'1': '3.4', 'x': '3.6', '2': '2'}, 1563696240: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563695100: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563694380: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563693660: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563692580: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563692460: {'1': '3.5', 'x': '3.75', '2': '1.92'}, 1563692280: {'1': '3.6', 'x': '3.7', '2': '1.92'}, 1563689280: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563687360: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563685560: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563682320: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563682200: {'1': '3.4', 'x': '3.6', '2': '2'}, 1563681960: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563681780: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563681660: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563680580: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563680280: {'1': '3.6', 'x': '3.7', '2': '1.92'}, 1563679860: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563679140: {'1': '3.6', 'x': '3.7', '2': '1.92'}, 1563678180: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563676980: {'1': '3.6', 'x': '3.7', '2': '1.92'}, 1563676860: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563676740: {'1': '3.6', 'x': '3.7', '2': '1.91'}, 1563674100: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563672180: {'1': '3.6', 'x': '3.75', '2': '1.91'}, 1563671520: {'1': '3.6', 'x': '3.7', '2': '1.91'}, 1563671400: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563666300: {'1': '3.6', 'x': '3.7', '2': '1.91'}, 1563651780: {'1': '3.6', 'x': '3.75', '2': '1.9'}, 1563651660: {'1': '3.6', 'x': '3.7', '2': '1.91'}, 1563649260: {'1': '3.6', 'x': '3.75', '2': '1.9'}, 1563648540: {'1': '3.5', 'x': '3.7', '2': '1.92'}, 1563647940: {'1': '3.6', 'x': '3.7', '2': '1.92'}, 1563646920: {'1': '3.4', 'x': '3.7', '2': '2'}, 1563645660: {'1': '3.3', 'x': '3.7', '2': '2'}, 1563645540: {'1': '3.2', 'x': '3.6', '2': '2.1'}, 1563644400: {'1': '3.25', 'x': '3.6', '2': '2.05'}, 1563643200: {'1': '3.5', 'x': '3.7', '2': '1.95'}, 1563642540: {'1': '3.5', 'x': '3.6', '2': '1.95'}, 1563642060: {'1': '3.3', 'x': '3.6', '2': '2.05'}, 1563641820: {'1': '3.2', 'x': '3.6', '2': '2.1'}, 1563641700: {'1': '3.1', 'x': '3.6', '2': '2.15'}, 1563631440: {'1': '3.2', 'x': '3.6', '2': '2.1'}, 1563629700: {'1': '3.3', 'x': '3.6', '2': '2.05'}, 1563620280: {'1': '3.2', 'x': '3.6', '2': '2.1'}, 1563619200: {'1': '3.12', 'x': '3.7', '2': '2.1'}, 1563603120: {'1': '3.2', 'x': '3.6', '2': '2.1'}, 1563603000: {'1': '3.12', 'x': '3.6', '2': '2.1'}, 1563602160: {'1': '3.12', 'x': '3.7', '2': '2.1'}, 1563592920: {'1': '3.12', 'x': '3.6', '2': '2.1'}, 1563571980: {'1': '3.1', 'x': '3.6', '2': '2.15'}, 1563561720: {'1': '3.12', 'x': '3.6', '2': '2.1'}, 1563561600: {'1': '3.1', 'x': '3.6', '2': '2.15'}, 1563558900: {'1': '3', 'x': '3.6', '2': '2.2'}, 1563558120: {'1': '3', 'x': '3.6', '2': '2.15'}, 1563453720: {'1': '3', 'x': '3.6', '2': '2.2'}, 1563450780: {'1': '3.1', 'x': '3.6', '2': '2.15'}, 1563438180: {'1': '3', 'x': '3.6', '2': '2.2'}, 1563434700: {'1': '2.9', 'x': '3.6', '2': '2.25'}, 1563430260: {'1': '2.88', 'x': '3.6', '2': '2.25'}, 1563421080: {'1': '2.9', 'x': '3.6', '2': '2.25'}, 1563420480: {'1': '3', 'x': '3.6', '2': '2.2'}, 1563418320: {'1': '2.9', 'x': '3.6', '2': '2.25'}, 1563417000: {'1': '2.88', 'x': '3.6', '2': '2.25'}, 1563416400: {'1': '2.8', 'x': '3.6', '2': '2.3'}, 1563414960: {'1': '2.88', 'x': '3.6', '2': '2.25'}, 1563414000: {'1': '2.9', 'x': '3.6', '2': '2.2'}, 1563395880: {'1': '3', 'x': '3.6', '2': '2.2'}, 1563380700: {'1': '2.88', 'x': '3.6', '2': '2.25'}, 1563379260: {'1': '2.8', 'x': '3.6', '2': '2.3'}, 1563378300: {'1': '2.5', 'x': '3.7', '2': '2.5'}, 1563377880: {'1': '2.4', 'x': '3.75', '2': '2.6'}, 1563377460: {'1': '2.4', 'x': '3.6', '2': '2.7'}}, 'pinnacle': {1563699780: {'1': '3.68', 'x': '3.76', '2': '1.99'}, 1563699240: {'1': '3.62', 'x': '3.7', '2': '2.03'}, 1563698880: {'1': '3.63', 'x': '3.69', '2': '2.03'}, 1563697920: {'1': '3.58', 'x': '3.85', '2': '2'}, 1563693360: {'1': '3.56', 'x': '3.83', '2': '2.01'}, 1563688800: {'1': '3.55', 'x': '3.82', '2': '2.02'}, 1563688740: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563688620: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563688320: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563688200: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563687720: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563687600: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563687180: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563687060: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563686640: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563686580: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563686400: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563686340: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563685860: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563685740: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563685440: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563685200: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563685140: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563685080: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563684840: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563684660: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563684600: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563684480: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563684360: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563684240: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563684120: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563683940: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563683700: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563683520: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563683340: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563683220: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563683160: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563682980: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563682920: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563682800: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563682680: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563682620: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563682500: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563682440: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563682260: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563682200: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563682080: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563682020: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563681840: {'1': '3.54', 'x': '3.86', '2': '2.01'}, 1563674700: {'1': '3.53', 'x': '3.85', '2': '2.02'}, 1563674100: {'1': '3.46', 'x': '3.8', '2': '2.05'}, 1563671160: {'1': '3.58', 'x': '3.89', '2': '1.99'}, 1563659040: {'1': '3.58', 'x': '3.88', '2': '1.99'}, 1563657420: {'1': '3.58', 'x': '3.9', '2': '1.99'}, 1563651000: {'1': '3.57', 'x': '3.93', '2': '1.98'}, 1563646920: {'1': '3.59', 'x': '3.94', '2': '1.97'}, 1563643740: {'1': '3.46', 'x': '3.81', '2': '2.05'}, 1563642180: {'1': '3.44', 'x': '3.79', '2': '2.06'}, 1563642120: {'1': '3.42', 'x': '3.85', '2': '2.05'}, 1563641880: {'1': '3.4', 'x': '3.92', '2': '2.04'}, 1563628500: {'1': '3.26', 'x': '3.76', '2': '2.14'}, 1563616500: {'1': '3.2', 'x': '3.73', '2': '2.17'}, 1563541380: {'1': '3.18', 'x': '3.81', '2': '2.16'}, 1563541260: {'1': '3.07', 'x': '3.78', '2': '2.22'}, 1563519900: {'1': '2.99', 'x': '3.75', '2': '2.28'}, 1563478740: {'1': '2.98', 'x': '3.79', '2': '2.27'}, 1563462720: {'1': '3.06', 'x': '3.83', '2': '2.21'}, 1563452940: {'1': '3.04', 'x': '3.8', '2': '2.23'}, 1563439920: {'1': '3.03', 'x': '3.84', '2': '2.22'}, 1563432720: {'1': '3.02', 'x': '3.9', '2': '2.21'}, 1563432660: {'1': '2.97', 'x': '3.88', '2': '2.24'}, 1563425280: {'1': '2.92', 'x': '3.83', '2': '2.29'}, 1563386460: {'1': '2.95', 'x': '3.82', '2': '2.28'}, 1563378000: {'1': '2.95', 'x': '3.84', '2': '2.27'}, 1563377760: {'1': '2.61', 'x': '3.96', '2': '2.47'}, 1563376920: {'1': '2.54', 'x': '3.96', '2': '2.53'}, 1563376260: {'1': '2.44', 'x': '3.81', '2': '2.72'}, 1563376140: {'1': '2.47', 'x': '3.68', '2': '2.75'}}}, 'probabilities': {'bet365': {1563682200: {'1': 0.26865671641791045, 'x': 0.2611940298507463, '2': 0.4701492537313433}, 1563682020: {'1': 0.2611940298507463, 'x': 0.26865671641791045, '2': 0.4701492537313433}, 1563648180: {'1': 0.24657534246575338, 'x': 0.2602739726027397, '2': 0.49315068493150677}, 1563628620: {'1': 0.27548473795354195, 'x': 0.2676137454405836, '2': 0.4569015166058745}, 1563479580: {'1': 0.28767123287671237, 'x': 0.2671232876712329, '2': 0.4452054794520548}, 1563460980: {'1': 0.27370948379351745, 'x': 0.25090036014405764, '2': 0.47539015606242496}, 1563407580: {'1': 0.303508080409933, 'x': 0.26882144264879776, '2': 0.4276704769412692}}, 'betvictor': {1563697860: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563697440: {'1': 0.2739533576847429, 'x': 0.24838437763416685, '2': 0.4776622646810902}, 1563696660: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563696600: {'1': 0.27439024390243905, 'x': 0.25914634146341464, '2': 0.46646341463414637}, 1563696240: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563695100: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563694380: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563693660: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563692580: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563692460: {'1': 0.26622296173044924, 'x': 0.24847476428175264, '2': 0.4853022739877982}, 1563692280: {'1': 0.2598770851624232, 'x': 0.2528533801580333, '2': 0.48726953467954354}, 1563689280: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563687360: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563685560: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563682320: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563682200: {'1': 0.27439024390243905, 'x': 0.25914634146341464, '2': 0.46646341463414637}, 1563681960: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563681780: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563681660: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563680580: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563680280: {'1': 0.2598770851624232, 'x': 0.2528533801580333, '2': 0.48726953467954354}, 1563679860: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563679140: {'1': 0.2598770851624232, 'x': 0.2528533801580333, '2': 0.48726953467954354}, 1563678180: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563676980: {'1': 0.2598770851624232, 'x': 0.2528533801580333, '2': 0.48726953467954354}, 1563676860: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563676740: {'1': 0.25921578696401715, 'x': 0.2522099548839085, '2': 0.48857425815207417}, 1563674100: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563672180: {'1': 0.26009041886813006, 'x': 0.24968680211340483, '2': 0.49022277901846495}, 1563671520: {'1': 0.25921578696401715, 'x': 0.2522099548839085, '2': 0.48857425815207417}, 1563671400: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563666300: {'1': 0.25921578696401715, 'x': 0.2522099548839085, '2': 0.48857425815207417}, 1563651780: {'1': 0.2594210813762971, 'x': 0.24904423812124518, '2': 0.4915346805024576}, 1563651660: {'1': 0.25921578696401715, 'x': 0.2522099548839085, '2': 0.48857425815207417}, 1563649260: {'1': 0.2594210813762971, 'x': 0.24904423812124518, '2': 0.4915346805024576}, 1563648540: {'1': 0.26533203854485693, 'x': 0.2509897661910809, '2': 0.4836781952640622}, 1563647940: {'1': 0.2598770851624232, 'x': 0.2528533801580333, '2': 0.48726953467954354}, 1563646920: {'1': 0.2763256161314414, 'x': 0.25392083644510827, '2': 0.4697535474234503}, 1563645660: {'1': 0.2823349866463182, 'x': 0.2518122853872567, '2': 0.465852727966425}, 1563645540: {'1': 0.2930232558139535, 'x': 0.26046511627906976, '2': 0.44651162790697674}, 1563644400: {'1': 0.28668544236185295, 'x': 0.2588132465766728, '2': 0.4545013110614742}, 1563643200: {'1': 0.2673212300852167, 'x': 0.25287143386439415, '2': 0.479807336050389}, 1563642540: {'1': 0.2654566080544526, 'x': 0.25808281338627337, '2': 0.47646057855927393}, 1563642060: {'1': 0.28357348703170027, 'x': 0.25994236311239194, '2': 0.4564841498559078}, 1563641820: {'1': 0.2930232558139535, 'x': 0.26046511627906976, '2': 0.44651162790697674}, 1563641700: {'1': 0.30275767651085467, 'x': 0.26070799921768045, '2': 0.4365343242714649}, 1563631440: {'1': 0.2930232558139535, 'x': 0.26046511627906976, '2': 0.44651162790697674}, 1563629700: {'1': 0.28357348703170027, 'x': 0.25994236311239194, '2': 0.4564841498559078}, 1563620280: {'1': 0.2930232558139535, 'x': 0.26046511627906976, '2': 0.44651162790697674}, 1563619200: {'1': 0.3003943400603109, 'x': 0.25330549756437026, '2': 0.44630016237531905}, 1563603120: {'1': 0.2930232558139535, 'x': 0.26046511627906976, '2': 0.44651162790697674}, 1563603000: {'1': 0.29829545454545453, 'x': 0.2585227272727273, '2': 0.4431818181818182}, 1563602160: {'1': 0.3003943400603109, 'x': 0.25330549756437026, '2': 0.44630016237531905}, 1563592920: {'1': 0.29829545454545453, 'x': 0.2585227272727273, '2': 0.4431818181818182}, 1563571980: {'1': 0.30275767651085467, 'x': 0.26070799921768045, '2': 0.4365343242714649}, 1563561720: {'1': 0.29829545454545453, 'x': 0.2585227272727273, '2': 0.4431818181818182}, 1563561600: {'1': 0.30275767651085467, 'x': 0.26070799921768045, '2': 0.4365343242714649}, 1563558900: {'1': 0.31279620853080564, 'x': 0.2606635071090047, '2': 0.42654028436018954}, 1563558120: {'1': 0.3097238895558223, 'x': 0.2581032412965186, '2': 0.43217286914765907}, 1563453720: {'1': 0.31279620853080564, 'x': 0.2606635071090047, '2': 0.42654028436018954}, 1563450780: {'1': 0.30275767651085467, 'x': 0.26070799921768045, '2': 0.4365343242714649}, 1563438180: {'1': 0.31279620853080564, 'x': 0.2606635071090047, '2': 0.42654028436018954}, 1563434700: {'1': 0.32315978456014366, 'x': 0.26032315978456017, '2': 0.41651705565529623}, 1563430260: {'1': 0.3246753246753247, 'x': 0.25974025974025977, '2': 0.41558441558441556}, 1563421080: {'1': 0.32315978456014366, 'x': 0.26032315978456017, '2': 0.41651705565529623}, 1563420480: {'1': 0.31279620853080564, 'x': 0.2606635071090047, '2': 0.42654028436018954}, 1563418320: {'1': 0.32315978456014366, 'x': 0.26032315978456017, '2': 0.41651705565529623}, 1563417000: {'1': 0.3246753246753247, 'x': 0.25974025974025977, '2': 0.41558441558441556}, 1563416400: {'1': 0.3338709677419355, 'x': 0.2596774193548387, '2': 0.4064516129032258}, 1563414960: {'1': 0.3246753246753247, 'x': 0.25974025974025977, '2': 0.41558441558441556}, 1563414000: {'1': 0.32012934518997577, 'x': 0.25788197251414713, '2': 0.4219886822958771}, 1563395880: {'1': 0.31279620853080564, 'x': 0.2606635071090047, '2': 0.42654028436018954}, 1563380700: {'1': 0.3246753246753247, 'x': 0.25974025974025977, '2': 0.41558441558441556}, 1563379260: {'1': 0.3338709677419355, 'x': 0.2596774193548387, '2': 0.4064516129032258}, 1563378300: {'1': 0.3737373737373737, 'x': 0.25252525252525243, '2': 0.3737373737373737}, 1563377880: {'1': 0.39015606242497003, 'x': 0.24969987995198079, '2': 0.3601440576230492}, 1563377460: {'1': 0.391304347826087, 'x': 0.2608695652173913, '2': 0.3478260869565217}}, 'pinnacle': {1563699780: {'1': 0.26123509203139406, 'x': 0.25567689858391757, '2': 0.4830880093846885}, 1563699240: {'1': 0.26584222895489423, 'x': 0.26009428886938296, '2': 0.47406348217572275}, 1563698880: {'1': 0.26511716800628576, 'x': 0.260806319746021, '2': 0.47407651224769326}, 1563697920: {'1': 0.2688265893935691, 'x': 0.24997381559194218, '2': 0.4811995950144887}, 1563693360: {'1': 0.27022293049524904, 'x': 0.2511732722096831, '2': 0.47860379729506797}, 1563688800: {'1': 0.271241967913837, 'x': 0.25207041520788515, '2': 0.4766876168782779}, 1563688740: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563688620: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563688320: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563688200: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563687720: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563687600: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563687180: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563687060: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563686640: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563686580: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563686400: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563686340: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563685860: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563685740: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563685440: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563685200: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563685140: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563685080: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563684840: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563684660: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563684600: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563684480: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563684360: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563684240: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563684120: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563683940: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563683700: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563683520: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563683340: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563683220: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563683160: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563682980: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563682920: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563682800: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563682680: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563682620: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563682500: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563682440: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563682260: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563682200: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563682080: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563682020: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563681840: {'1': 0.27186527625935575, 'x': 0.24932722226894286, '2': 0.4788075014717012}, 1563674700: {'1': 0.27289538600819, 'x': 0.2502131721062106, '2': 0.4768914418855994}, 1563674100: {'1': 0.2779066034033748, 'x': 0.2530412757304413, '2': 0.46905212086618386}, 1563671160: {'1': 0.268867547713735, 'x': 0.24744108504246046, '2': 0.4836913672438046}, 1563659040: {'1': 0.2686961908142456, 'x': 0.24792071214304112, '2': 0.48338309704271326}, 1563657420: {'1': 0.2690382428797249, 'x': 0.2469633101306193, '2': 0.48399844698965583}, 1563651000: {'1': 0.2694381252142479, 'x': 0.24475677023279008, '2': 0.48580510455296216}, 1563646920: {'1': 0.26784500339904826, 'x': 0.24405166553365054, '2': 0.4881033310673011}, 1563643740: {'1': 0.2780912978305995, 'x': 0.25254485314799846, '2': 0.4693638490214021}, 1563642180: {'1': 0.2795205396077533, 'x': 0.2537072971637655, '2': 0.4667721632284812}, 1563642120: {'1': 0.28116706150585136, 'x': 0.2497639871038991, '2': 0.4690689513902496}, 1563641880: {'1': 0.2829643888354187, 'x': 0.24542829643888353, '2': 0.4716073147256977}, 1563628500: {'1': 0.2949516869254116, 'x': 0.2557293881321388, '2': 0.4493189249424495}, 1563616500: {'1': 0.30006932576063705, 'x': 0.2574321293388844, '2': 0.44249854490047863}, 1563541380: {'1': 0.30240095244394466, 'x': 0.25239764534691445, '2': 0.44520140220914073}, 1563541260: {'1': 0.3129839323277984, 'x': 0.2541959450387146, '2': 0.4328201226334869}, 1563519900: {'1': 0.32167405952663125, 'x': 0.25648145012923396, '2': 0.42184449034413485}, 1563478740: {'1': 0.32267900878025363, 'x': 0.25371594885624166, '2': 0.4236050423635047}, 1563462720: {'1': 0.31411267427922535, 'x': 0.25096208441107815, '2': 0.4349252413096966}, 1563452940: {'1': 0.3161326906719592, 'x': 0.2529061525375673, '2': 0.43096115679047353}, 1563439920: {'1': 0.3170650063600455, 'x': 0.2501841065809734, '2': 0.43275088705898096}, 1563432720: {'1': 0.31838263542066847, 'x': 0.2465424510180561, '2': 0.4350749135612754}, 1563432660: {'1': 0.3234825589185487, 'x': 0.2476142268010541, '2': 0.4289032142803972}, 1563425280: {'1': 0.32921688669011406, 'x': 0.25099564207183633, '2': 0.41978747123804944}, 1563386460: {'1': 0.3261460572335852, 'x': 0.2518667195913813, '2': 0.42198722317503357}, 1563378000: {'1': 0.32596769790548696, 'x': 0.250417892922184, '2': 0.42361440917232884}, 1563377760: {'1': 0.36821954938167034, 'x': 0.24269015754701, '2': 0.38909029307131965}, 1563376920: {'1': 0.3780194239229683, 'x': 0.24246700423341908, '2': 0.3795135718436125}, 1563376260: {'1': 0.39409196696125703, 'x': 0.2523843567940859, '2': 0.353523676244657}, 1563376140: {'1': 0.3891993338999542, 'x': 0.2612289007426323, '2': 0.3495717653574134}}}},
				{'game_id': 1662665, 'league_id': 15, 'kickoff': 1563703200.0, 'home_team_name': 'Suwon Samsung Bluewings', 'away_team_name': 'Seongnam FC', 'home_team_id': 499, 'away_team_id': 477, 'home_team_rank': 6, 'away_team_rank': 9, 'league_name': 'Korea League', 'odds': {'bet365': {1563699660: {'1': '1.83', 'x': '3.4', '2': '4.2'}, 1563526620: {'1': '1.8', 'x': '3.4', '2': '4.2'}, 1563455460: {'1': '1.75', 'x': '3.4', '2': '4.33'}}, 'betvictor': {1563699840: {'1': '1.9', 'x': '3.25', '2': '4.4'}, 1563699540: {'1': '1.9', 'x': '3.3', '2': '4.33'}, 1563699480: {'1': '1.9', 'x': '3.3', '2': '4.4'}, 1563699420: {'1': '1.9', 'x': '3.3', '2': '4.33'}, 1563698940: {'1': '1.87', 'x': '3.4', '2': '4.4'}, 1563698820: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563698640: {'1': '1.87', 'x': '3.4', '2': '4.4'}, 1563698520: {'1': '1.9', 'x': '3.3', '2': '4.33'}, 1563698220: {'1': '1.87', 'x': '3.4', '2': '4.4'}, 1563695760: {'1': '1.87', 'x': '3.4', '2': '4.33'}, 1563695640: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563695580: {'1': '1.87', 'x': '3.4', '2': '4.33'}, 1563695400: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563693060: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563690660: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563687120: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563686880: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563686340: {'1': '1.87', 'x': '3.4', '2': '4.33'}, 1563685980: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563685860: {'1': '1.87', 'x': '3.4', '2': '4.33'}, 1563685800: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563684840: {'1': '1.87', 'x': '3.4', '2': '4.33'}, 1563684360: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563683520: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563683400: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563682680: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563682560: {'1': '1.85', 'x': '3.4', '2': '4.5'}, 1563682200: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563681960: {'1': '1.85', 'x': '3.4', '2': '4.5'}, 1563681840: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563680580: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563680280: {'1': '1.85', 'x': '3.4', '2': '4.5'}, 1563679860: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563678360: {'1': '1.85', 'x': '3.4', '2': '4.5'}, 1563678120: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563661200: {'1': '1.83', 'x': '3.4', '2': '4.5'}, 1563661140: {'1': '1.85', 'x': '3.4', '2': '4.5'}, 1563659160: {'1': '1.87', 'x': '3.4', '2': '4.4'}, 1563658680: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563658560: {'1': '1.87', 'x': '3.4', '2': '4.33'}, 1563658440: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563628560: {'1': '1.85', 'x': '3.5', '2': '4.3'}, 1563628440: {'1': '1.83', 'x': '3.5', '2': '4.4'}, 1563615300: {'1': '1.85', 'x': '3.5', '2': '4.3'}, 1563612480: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563610500: {'1': '1.87', 'x': '3.4', '2': '4.3'}, 1563556080: {'1': '1.85', 'x': '3.5', '2': '4.33'}, 1563555780: {'1': '1.85', 'x': '3.4', '2': '4.4'}, 1563533820: {'1': '1.85', 'x': '3.5', '2': '4.33'}, 1563533520: {'1': '1.83', 'x': '3.5', '2': '4.4'}, 1563526440: {'1': '1.85', 'x': '3.5', '2': '4.33'}, 1563522480: {'1': '1.87', 'x': '3.4', '2': '4.3'}, 1563521760: {'1': '1.85', 'x': '3.5', '2': '4.33'}, 1563469320: {'1': '1.87', 'x': '3.4', '2': '4.3'}, 1563469200: {'1': '1.85', 'x': '3.5', '2': '4.33'}, 1563469140: {'1': '1.83', 'x': '3.5', '2': '4.5'}, 1563453180: {'1': '1.8', 'x': '3.5', '2': '4.6'}, 1563451500: {'1': '1.75', 'x': '3.5', '2': '4.75'}}, 'pinnacle': {1563700140: {'1': '1.94', 'x': '3.32', '2': '4.49'}, 1563699480: {'1': '1.93', 'x': '3.35', '2': '4.49'}, 1563699420: {'1': '1.93', 'x': '3.36', '2': '4.48'}, 1563699360: {'1': '1.92', 'x': '3.38', '2': '4.47'}, 1563699240: {'1': '1.92', 'x': '3.39', '2': '4.47'}, 1563698760: {'1': '1.92', 'x': '3.42', '2': '4.46'}, 1563698460: {'1': '1.89', 'x': '3.44', '2': '4.53'}, 1563697980: {'1': '1.88', 'x': '3.46', '2': '4.56'}, 1563697140: {'1': '1.91', 'x': '3.41', '2': '4.49'}, 1563695760: {'1': '1.92', 'x': '3.4', '2': '4.49'}, 1563692340: {'1': '1.91', 'x': '3.41', '2': '4.5'}, 1563688500: {'1': '1.88', 'x': '3.47', '2': '4.58'}, 1563687000: {'1': '1.88', 'x': '3.46', '2': '4.58'}, 1563683340: {'1': '1.88', 'x': '3.45', '2': '4.58'}, 1563681120: {'1': '1.88', 'x': '3.46', '2': '4.59'}, 1563676680: {'1': '1.88', 'x': '3.44', '2': '4.58'}, 1563676260: {'1': '1.9', 'x': '3.42', '2': '4.54'}, 1563671940: {'1': '1.9', 'x': '3.41', '2': '4.53'}, 1563658860: {'1': '1.9', 'x': '3.4', '2': '4.53'}, 1563658800: {'1': '1.92', 'x': '3.39', '2': '4.52'}, 1563658620: {'1': '1.89', 'x': '3.45', '2': '4.5'}, 1563658500: {'1': '1.93', 'x': '3.39', '2': '4.4'}, 1563658440: {'1': '1.94', 'x': '3.38', '2': '4.41'}, 1563615180: {'1': '1.88', 'x': '3.56', '2': '4.36'}, 1563469080: {'1': '1.92', 'x': '3.45', '2': '4.4'}, 1563462300: {'1': '1.84', 'x': '3.49', '2': '4.73'}, 1563450420: {'1': '1.8', 'x': '3.56', '2': '4.87'}}}, 'probabilities': {'bet365': {1563699660: {'1': 0.506598552575564, 'x': 0.272669220945083, '2': 0.2207322264793529}, 1563526620: {'1': 0.5107296137339056, 'x': 0.27038626609442057, '2': 0.21888412017167377}, 1563455460: {'1': 0.5211419671144621, 'x': 0.2682348360147967, '2': 0.21062319687074105}}, 'betvictor': {1563699840: {'1': 0.49592509103520027, 'x': 0.2899254378359633, '2': 0.2141494711288365}, 1563699540: {'1': 0.4963871326339192, 'x': 0.28579865212255956, '2': 0.21781421524352113}, 1563699480: {'1': 0.49811320754716976, 'x': 0.28679245283018867, '2': 0.2150943396226415}, 1563699420: {'1': 0.4963871326339192, 'x': 0.28579865212255956, '2': 0.21781421524352113}, 1563698940: {'1': 0.5063291139240506, 'x': 0.27848101265822783, '2': 0.2151898734177215}, 1563698820: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563698640: {'1': 0.5063291139240506, 'x': 0.27848101265822783, '2': 0.2151898734177215}, 1563698520: {'1': 0.4963871326339192, 'x': 0.28579865212255956, '2': 0.21781421524352113}, 1563698220: {'1': 0.5063291139240506, 'x': 0.27848101265822783, '2': 0.2151898734177215}, 1563695760: {'1': 0.5045737924605255, 'x': 0.27751558585328906, '2': 0.21791062168618539}, 1563695640: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563695580: {'1': 0.5045737924605255, 'x': 0.27751558585328906, '2': 0.21791062168618539}, 1563695400: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563693060: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563690660: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563687120: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563686880: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563686340: {'1': 0.5045737924605255, 'x': 0.27751558585328906, '2': 0.21791062168618539}, 1563685980: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563685860: {'1': 0.5045737924605255, 'x': 0.27751558585328906, '2': 0.21791062168618539}, 1563685800: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563684840: {'1': 0.5045737924605255, 'x': 0.27751558585328906, '2': 0.21791062168618539}, 1563684360: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563683520: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563683400: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563682680: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563682560: {'1': 0.5114491057997661, 'x': 0.2782884840381081, '2': 0.21026241016212607}, 1563682200: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563681960: {'1': 0.5114491057997661, 'x': 0.2782884840381081, '2': 0.21026241016212607}, 1563681840: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563680580: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563680280: {'1': 0.5114491057997661, 'x': 0.2782884840381081, '2': 0.21026241016212607}, 1563679860: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563678360: {'1': 0.5114491057997661, 'x': 0.2782884840381081, '2': 0.21026241016212607}, 1563678120: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563661200: {'1': 0.5141647343482205, 'x': 0.27674160701683637, '2': 0.209093658634943}, 1563661140: {'1': 0.5114491057997661, 'x': 0.2782884840381081, '2': 0.21026241016212607}, 1563659160: {'1': 0.5063291139240506, 'x': 0.27848101265822783, '2': 0.2151898734177215}, 1563658680: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563658560: {'1': 0.5045737924605255, 'x': 0.27751558585328906, '2': 0.21791062168618539}, 1563658440: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563628560: {'1': 0.5105156037991859, 'x': 0.26984396200814115, '2': 0.219640434192673}, 1563628440: {'1': 0.5157919415882373, 'x': 0.2696855008875641, '2': 0.21452255752419871}, 1563615300: {'1': 0.5105156037991859, 'x': 0.26984396200814115, '2': 0.219640434192673}, 1563612480: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563610500: {'1': 0.5038078500292911, 'x': 0.27709431751611013, '2': 0.2190978324545987}, 1563556080: {'1': 0.511293669135136, 'x': 0.2702552251142862, '2': 0.21845110575057775}, 1563555780: {'1': 0.5090166723375298, 'x': 0.2769649540660089, '2': 0.2140183735964614}, 1563533820: {'1': 0.511293669135136, 'x': 0.2702552251142862, '2': 0.21845110575057775}, 1563533520: {'1': 0.5157919415882373, 'x': 0.2696855008875641, '2': 0.21452255752419871}, 1563526440: {'1': 0.511293669135136, 'x': 0.2702552251142862, '2': 0.21845110575057775}, 1563522480: {'1': 0.5038078500292911, 'x': 0.27709431751611013, '2': 0.2190978324545987}, 1563521760: {'1': 0.511293669135136, 'x': 0.2702552251142862, '2': 0.21845110575057775}, 1563469320: {'1': 0.5038078500292911, 'x': 0.27709431751611013, '2': 0.2190978324545987}, 1563469200: {'1': 0.511293669135136, 'x': 0.2702552251142862, '2': 0.21845110575057775}, 1563469140: {'1': 0.5182625863770978, 'x': 0.27097729516288255, '2': 0.21076011846001974}, 1563453180: {'1': 0.5247718383311604, 'x': 0.26988265971316816, '2': 0.20534550195567147}, 1563451500: {'1': 0.5352112676056339, 'x': 0.26760563380281693, '2': 0.1971830985915493}}, 'pinnacle': {1563700140: {'1': 0.49593122675343165, 'x': 0.2897911385245956, '2': 0.21427763472197264}, 1563699480: {'1': 0.4985135569571169, 'x': 0.2872033328141001, '2': 0.21428311022878294}, 1563699420: {'1': 0.49870129870129865, 'x': 0.286456400742115, '2': 0.2148423005565862}, 1563699360: {'1': 0.5006063497743584, 'x': 0.28436810401383666, '2': 0.21502554621180492}, 1563699240: {'1': 0.5010266329415265, 'x': 0.28376729653325394, '2': 0.21520607052521945}, 1563698760: {'1': 0.5020340455784194, 'x': 0.28184367471069155, '2': 0.21612227971088907}, 1563698460: {'1': 0.5084822084087907, 'x': 0.27936958543389945, '2': 0.21214820615730995}, 1563697980: {'1': 0.5113433068007985, 'x': 0.27783971583395994, '2': 0.21081697736524155}, 1563697140: {'1': 0.503649683058168, 'x': 0.28210290165428176, '2': 0.21424741528755029}, 1563695760: {'1': 0.501926693583387, 'x': 0.2834409563765009, '2': 0.21463235004011202}, 1563692340: {'1': 0.5038895875953515, 'x': 0.2822372763363992, '2': 0.2138731360682492}, 1563688500: {'1': 0.5122249940373744, 'x': 0.27751671146693485, '2': 0.2102582944956908}, 1563687000: {'1': 0.5118144822685873, 'x': 0.27809573024998385, '2': 0.21008978748142884}, 1563683340: {'1': 0.5114022539113323, 'x': 0.27867717024733474, '2': 0.20992057584133295}, 1563681120: {'1': 0.5120488531503704, 'x': 0.278223076278236, '2': 0.2097280705713936}, 1563676680: {'1': 0.5109882981759684, 'x': 0.27926104667756413, '2': 0.20975065514646737}, 1563676260: {'1': 0.5065707909744607, 'x': 0.28142821720803374, '2': 0.2120009918175056}, 1563671940: {'1': 0.5059164911752088, 'x': 0.2818889540272424, '2': 0.21219455479754892}, 1563658860: {'1': 0.5054973907906397, 'x': 0.2824838360300634, '2': 0.212018773179297}, 1563658800: {'1': 0.5022222222222222, 'x': 0.28444444444444444, '2': 0.21333333333333335}, 1563658620: {'1': 0.5081749889527176, 'x': 0.27839151568714093, '2': 0.21343349536014133}, 1563658500: {'1': 0.4980184102541844, 'x': 0.2835326052479575, '2': 0.21844898449785813}, 1563658440: {'1': 0.49655544599312423, 'x': 0.2850051968126216, '2': 0.21843935719425417}, 1563615180: {'1': 0.5103909086126164, 'x': 0.26953227758194354, '2': 0.22007681380544009}, 1563469080: {'1': 0.5017850059500198, 'x': 0.27925426418088056, '2': 0.21896072986909954}, 1563462300: {'1': 0.5218588477041017, 'x': 0.27513475065201926, '2': 0.2030064016438789}, 1563450420: {'1': 0.5332685351509634, 'x': 0.2696301582223972, '2': 0.19710130662663944}}}},
				{'game_id': 1662666, 'league_id': 15, 'kickoff': 1563703200.0, 'home_team_name': 'Sangju Sangmu Phoenix', 'away_team_name': 'Daegu FC', 'home_team_id': 494, 'away_team_id': 491, 'home_team_rank': 8, 'away_team_rank': 5, 'league_name': 'Korea League', 'odds': {'bet365': {1563683820: {'1': '2.8', 'x': '3.2', '2': '2.37'}, 1563537000: {'1': '2.9', 'x': '3.2', '2': '2.3'}, 1563455460: {'1': '2.75', 'x': '3.1', '2': '2.45'}}, 'betvictor': {1563687000: {'1': '3', 'x': '3.2', '2': '2.4'}, 1563686400: {'1': '2.9', 'x': '3.2', '2': '2.45'}, 1563686340: {'1': '2.88', 'x': '3.2', '2': '2.5'}, 1563682920: {'1': '2.9', 'x': '3.2', '2': '2.45'}, 1563682440: {'1': '2.9', 'x': '3.2', '2': '2.5'}, 1563679020: {'1': '2.9', 'x': '3.2', '2': '2.45'}, 1563678300: {'1': '3', 'x': '3.2', '2': '2.4'}, 1563678120: {'1': '2.9', 'x': '3.2', '2': '2.45'}, 1563676740: {'1': '3', 'x': '3.2', '2': '2.4'}, 1563671400: {'1': '2.9', 'x': '3.2', '2': '2.45'}, 1563671340: {'1': '2.9', 'x': '3.2', '2': '2.5'}, 1563598200: {'1': '2.9', 'x': '3.2', '2': '2.45'}, 1563585060: {'1': '2.9', 'x': '3.2', '2': '2.5'}, 1563536880: {'1': '2.9', 'x': '3.25', '2': '2.45'}, 1563525240: {'1': '2.9', 'x': '3.2', '2': '2.5'}, 1563521520: {'1': '2.88', 'x': '3.2', '2': '2.5'}, 1563521400: {'1': '2.9', 'x': '3.2', '2': '2.5'}, 1563500760: {'1': '2.88', 'x': '3.2', '2': '2.5'}, 1563473340: {'1': '2.8', 'x': '3.2', '2': '2.55'}, 1563472680: {'1': '2.88', 'x': '3.2', '2': '2.5'}, 1563453360: {'1': '2.8', 'x': '3.2', '2': '2.55'}, 1563451500: {'1': '2.8', 'x': '3.25', '2': '2.55'}}, 'pinnacle': {1563699780: {'1': '3.07', 'x': '3.17', '2': '2.51'}, 1563696660: {'1': '3.06', 'x': '3.19', '2': '2.5'}, 1563694860: {'1': '3.05', 'x': '3.18', '2': '2.52'}, 1563694020: {'1': '3.03', 'x': '3.23', '2': '2.5'}, 1563693600: {'1': '3', 'x': '3.23', '2': '2.52'}, 1563688860: {'1': '3.02', 'x': '3.23', '2': '2.5'}, 1563686400: {'1': '3.01', 'x': '3.23', '2': '2.51'}, 1563686040: {'1': '3.09', 'x': '3.23', '2': '2.46'}, 1563684420: {'1': '3.09', 'x': '3.22', '2': '2.46'}, 1563682620: {'1': '3.01', 'x': '3.22', '2': '2.52'}, 1563665940: {'1': '3', 'x': '3.21', '2': '2.54'}, 1563629280: {'1': '3.01', 'x': '3.18', '2': '2.55'}, 1563578940: {'1': '2.98', 'x': '3.24', '2': '2.53'}, 1563516840: {'1': '2.96', 'x': '3.23', '2': '2.55'}, 1563468900: {'1': '2.94', 'x': '3.21', '2': '2.57'}, 1563462120: {'1': '2.92', 'x': '3.27', '2': '2.55'}, 1563450360: {'1': '2.84', 'x': '3.27', '2': '2.61'}, 1563450300: {'1': '2.83', 'x': '3.31', '2': '2.6'}}}, 'probabilities': {'bet365': {1563683820: {'1': 0.3271786022433132, 'x': 0.28628127696289907, '2': 0.3865401207937877}, 1563537000: {'1': 0.3157443157443158, 'x': 0.28614328614328616, '2': 0.3981123981123982}, 1563455460: {'1': 0.33227605818659084, 'x': 0.2947610193590725, '2': 0.3729629224543366}}, 'betvictor': {1563687000: {'1': 0.3137254901960784, 'x': 0.29411764705882354, '2': 0.39215686274509803}, 1563686400: {'1': 0.3236326109391125, 'x': 0.2932920536635707, '2': 0.38307533539731675}, 1563686340: {'1': 0.327653997378768, 'x': 0.2948885976408912, '2': 0.3774574049803408}, 1563682920: {'1': 0.3236326109391125, 'x': 0.2932920536635707, '2': 0.38307533539731675}, 1563682440: {'1': 0.32613126783530366, 'x': 0.29555646147574394, '2': 0.3783122706889523}, 1563679020: {'1': 0.3236326109391125, 'x': 0.2932920536635707, '2': 0.38307533539731675}, 1563678300: {'1': 0.3137254901960784, 'x': 0.29411764705882354, '2': 0.39215686274509803}, 1563678120: {'1': 0.3236326109391125, 'x': 0.2932920536635707, '2': 0.38307533539731675}, 1563676740: {'1': 0.3137254901960784, 'x': 0.29411764705882354, '2': 0.39215686274509803}, 1563671400: {'1': 0.3236326109391125, 'x': 0.2932920536635707, '2': 0.38307533539731675}, 1563671340: {'1': 0.32613126783530366, 'x': 0.29555646147574394, '2': 0.3783122706889523}, 1563598200: {'1': 0.3236326109391125, 'x': 0.2932920536635707, '2': 0.38307533539731675}, 1563585060: {'1': 0.32613126783530366, 'x': 0.29555646147574394, '2': 0.3783122706889523}, 1563536880: {'1': 0.3250995202613045, 'x': 0.29008880269470244, '2': 0.384811677043993}, 1563525240: {'1': 0.32613126783530366, 'x': 0.29555646147574394, '2': 0.3783122706889523}, 1563521520: {'1': 0.327653997378768, 'x': 0.2948885976408912, '2': 0.3774574049803408}, 1563521400: {'1': 0.32613126783530366, 'x': 0.29555646147574394, '2': 0.3783122706889523}, 1563500760: {'1': 0.327653997378768, 'x': 0.2948885976408912, '2': 0.3774574049803408}, 1563473340: {'1': 0.33635614179719703, 'x': 0.2943116240725474, '2': 0.3693322341302556}, 1563472680: {'1': 0.327653997378768, 'x': 0.2948885976408912, '2': 0.3774574049803408}, 1563453360: {'1': 0.33635614179719703, 'x': 0.2943116240725474, '2': 0.3693322341302556}, 1563451500: {'1': 0.3378860462745897, 'x': 0.2911018244827234, '2': 0.37101212924268673}}, 'pinnacle': {1563699780: {'1': 0.31332621887588946, 'x': 0.30344211102491503, '2': 0.3832316700991955}, 1563696660: {'1': 0.31414458135064444, 'x': 0.3013424510761668, '2': 0.3845129675731888}, 1563694860: {'1': 0.3155134534974369, 'x': 0.3026151047695542, '2': 0.3818714417330089}, 1563694020: {'1': 0.3174522052608612, 'x': 0.2977957219629751, '2': 0.3847520727761638}, 1563693600: {'1': 0.3205879572738444, 'x': 0.29775971263824563, '2': 0.38165233008791005}, 1563688860: {'1': 0.3181689230720736, 'x': 0.29748301785686143, '2': 0.38434805907106495}, 1563686400: {'1': 0.319377420257084, 'x': 0.29762415943462006, '2': 0.38299842030829595}, 1563686040: {'1': 0.31125944554781243, 'x': 0.29776832406895987, '2': 0.39097223038322776}, 1563684420: {'1': 0.3109718754416545, 'x': 0.29841711028407214, '2': 0.3906110142742733}, 1563682620: {'1': 0.31956773446545733, 'x': 0.29872636047857964, '2': 0.3817059050559629}, 1563665940: {'1': 0.3209570372469827, 'x': 0.29995984789437635, '2': 0.379083114858641}, 1563629280: {'1': 0.3198021793400457, 'x': 0.3027058364193514, '2': 0.377491984240603}, 1563578940: {'1': 0.32282862971510484, 'x': 0.29692262856512724, '2': 0.3802487417197678}, 1563516840: {'1': 0.3249714937286203, 'x': 0.29780669394325576, '2': 0.37722181232812396}, 1563468900: {'1': 0.32681268792412915, 'x': 0.29932377024826784, '2': 0.37386354182760306}, 1563462120: {'1': 0.32915694610565704, 'x': 0.29392608031453166, '2': 0.37691697357981124}, 1563450360: {'1': 0.33822358018380033, 'x': 0.29374769655106814, '2': 0.36802872326513136}, 1563450300: {'1': 0.33973779474405186, 'x': 0.29047068251530717, '2': 0.36979152274064103}}}}
			]
		else:
			producer = KafkaProducer(value_serializer=lambda v: json.dumps(v).encode('utf-8'))
			consumer = KafkaConsumer(
					self.kafka_topic_input,
					bootstrap_servers='localhost:9092',
					value_deserializer=lambda m: json.loads(m.decode('utf-8')),
					auto_offset_reset='latest'  # or earliest
				)
			data_to_process = []
			for message in consumer:
				data_to_process.append(message.value)

		# Consume message one by one
		for game_data in data_to_process:
			game_prediction_info = self.game_predictor.get_prediction(game_data)
			# Produce new message on Kafka if game is qualified
			if game_prediction_info is False:
				print ("--- Game " + str(game_data['game_id']) + " is not qualified. ---")
			else:
				print("+++ Game " + str(game_data['game_id']) + " is predicted.")
				if debug_mode:
					print(game_prediction_info)
				else:
					print("Send message to Kafka under topic - " + self.kafka_topic_output + " +++")
					producer.send(self.kafka_topic_output, game_prediction_info)


if __name__ == '__main__':
	debug_mode = True
	while (True):
		Main().execute(debug_mode=debug_mode)
		if debug_mode:
			break
